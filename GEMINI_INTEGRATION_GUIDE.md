# 🤖 Gemini 웹 자동화 통합 가이드

이 가이드는 Streamlit 포트폴리오 관리 시스템에서 Gemini Deep Research를 자동화된 방식으로 사용하는 방법을 설명합니다.

## 📋 목차

1. [시스템 개요](#-시스템-개요)
2. [설치 및 설정](#-설치-및-설정)
3. [사용 방법](#-사용-방법)
4. [주요 기능](#-주요-기능)
5. [문제 해결](#-문제-해결)

## 🎯 시스템 개요

이 시스템은 다음과 같은 워크플로우를 자동화합니다:

```
포트폴리오 데이터 → 프롬프트 생성 → Gemini 웹 자동화 → 응답 수집 → 결과 저장
```

### 핵심 컴포넌트

1. **Streamlit 웹앱**: 포트폴리오 데이터 기반 프롬프트 생성
2. **Gemini 웹 자동화**: Selenium 기반 웹 브라우저 자동화
3. **응답 수집**: 자동 응답 모니터링 및 결과 저장
4. **통합 UI**: 모든 기능을 하나의 인터페이스로 관리

## 🚀 설치 및 설정

### 1. 필수 패키지 설치

```bash
pip install -r requirements.txt
```

추가된 패키지:
- `selenium>=4.15.0`: 웹 브라우저 자동화
- `webdriver-manager>=4.0.1`: Chrome 드라이버 자동 관리

### 2. Chrome 브라우저 설치

시스템에 Chrome 브라우저가 설치되어 있어야 합니다. Selenium은 자동으로 적절한 드라이버를 다운로드합니다.

### 3. Chrome 프로필 설정

로그인 상태를 유지하기 위해 Chrome 프로필을 설정할 수 있습니다:

```python
chrome_profile_path = "/Users/사용자명/Library/Application Support/Google/Chrome/Default"
```

## 🔧 사용 방법

### 1단계: 프롬프트 생성

다음 도구들에서 프롬프트를 생성하세요:

- **🎯 데일리 브리핑 생성기**: 포트폴리오 기반 매크로 분석
- **🔬 종목 상세 분석기**: 특정 종목의 깊이 있는 분석
- **⚖️ 포트폴리오 정밀 진단기**: 포트폴리오 전체 건강검진
- **🧭 유망 종목 탐색기**: 산업/종목 발굴 연구

각 프롬프트는 자동으로 `generated_prompts` 리스트에 저장됩니다.

### 2단계: Gemini 자동화 설정

**🤖 Gemini 웹 자동화** 페이지로 이동하여:

1. **설정 카드**에서 다음과 같이 설정:
   - ✅ 헤드리스 모드 (브라우저 창 숨김)
   - ✅ 자동 로그인 시도
   - ✅ 테스트 모드 (간단한 프롬프트로 테스트)

2. **Chrome 프로필 경로** 지정 (선택사항)

3. "설정 저장" 버튼 클릭

### 3단계: 프롬프트 전송

생성된 프롬프트 목록에서:

1. 원하는 프롬프트 선택
2. "Gemini에 전송하여 연구 시작" 클릭
3. 자동화 프로세스 진행 대기

### 4단계: 결과 확인

완료된 후:

- ✅ 응답 길이 및 생성 시간 표시
- 📝 전체 응답 내용 확인
- 📥 결과 파일 다운로드 가능

## ⚡ 주요 기능

### 🎛️ 브라우저 자동화

- **자동 로그인 감지**: Gemini 로그인 상태 확인
- **프롬프트 입력**: 텍스트 필드 자동 탐지 및 입력
- **응답 모니터링**: 실시간 응답 생성 상태 추적
- **타임아웃 관리**: 최대 5분 대기 후 안전 종료

### 📊 응답 수집

- **다중 선택자**: 다양한 페이지 구조에 대응
- **실시간 진행률**: 진행 상황 실시간 업데이트
- **안정화 감지**: 응답 완료 자동 감지
- **오류 처리**: 네트워크 오류 및 페이지 로딩 이슈 대응

### 💾 결과 관리

- **자동 파일 저장**: 타임스탬프별 파일명 생성
- **세션 상태 관리**: 생성된 프롬프트 리스트 유지
- **편집 기능**: 프롬프트 내용 수정 가능
- **다운로드 지원**: 결과 파일 직접 다운로드

## 🛠️ 문제 해결

### 일반적인 문제들

#### 1. Chrome 드라이버 오류

```
ChromeDriverManager를 사용하여 자동 해결됩니다.
```

**해결책:**
- 최신 Chrome 브라우저 설치
- 인터넷 연결 확인

#### 2. 로그인 필요 오류

```
로그인이 필요합니다. 브라우저에서 수동 로그인 후 다시 시도하세요.
```

**해결책:**
1. 수동으로 Chrome에서 Gemini에 로그인
2. Chrome 프로필 경로를 설정에 추가
3. 헤드리스 모드를 비활성화하여 상태 확인

#### 3. 응답 감지 실패

```
응답 완료를 감지하지 못했습니다.
```

**해결책:**
1. 프롬프트 길이 확인 (너무 길면 분할)
2. 타임아웃 시간 늘리기
3. 네트워크 안정성 확인

#### 4. 입력 필드 찾기 실패

```
입력 필드를 찾을 수 없습니다.
```

**해결책:**
1. Gemini 페이지 URL 확인 (`https://gemini.google.com/app/topic`)
2. 페이지 로딩 완료 대기
3. 수동으로 페이지 구조 확인

### 디버깅 팁

1. **헤드리스 모드 비활성화**: 브라우저 창을 보며 프로세스 확인
2. **로그 확인**: 콘솔 로그로 단계별 진행 상황 모니터링
3. **간단한 프롬프트 테스트**: 복잡한 프롬프트 대신 단순한 텍스트로 먼저 테스트

### 성능 최적화

1. **프롬프트 길이 제한**: 너무 긴 프롬프트는 분할하여 처리
2. **타임아웃 설정**: 프롬프트 복잡도에 따라 타임아웃 시간 조정
3. **Chrome 프로필 설정**: 로그인 상태 유지로 매번 로그인 과정 생략

## 📝 사용 예시

### 기본 워크플로우

1. **포트폴리오 업데이트** → 최신 데이터 확보
2. **종목 분석기** → 특정 종목 프롬프트 생성
3. **Gemini 웹 자동화** → 프롬프트 자동 전송
4. **결과 확인** → 생성된 응답 검토 및 다운로드

### 고급 워크플로우

1. **데일리 브리핑 생성기** → 매크로 분석 프롬프트 생성
2. **포트폴리오 진단기** → 포트폴리오 건강상태 프롬프트 생성
3. **유망 종목 탐색기** → 새로운 투자 기회 프롬프트 생성
4. **Gemini 웹 자동화** → 순차적 또는 병렬 연구 실행
5. **결과 비교 분석** → 한눈에 보는 포트폴리오 종합 리포트

## 🔮 향후 개선 계획

- **병렬 처리**: 여러 프롬프트 동시 실행
- **응답 분석**: 자동 응답 요약 및 핵심 포인트 추출
- **스케줄링**: 정기적 자동 브리핑 생성
- **통계 대시보드**: 연구 히스토리 및 패턴 분석

---

이제 Streamlit 기반 투자 분석 시스템의 모든 기능을 Gemini Deep Research와 완전히 통합하여 자동화된 연구 워크플로우를 구축했습니다! 🎉
