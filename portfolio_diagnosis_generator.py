"""
ν¬νΈν΄λ¦¬μ¤ μ •λ°€ μ§„λ‹¨κΈ° λ¨λ“
ν¬νΈν΄λ¦¬μ¤μ κµ¬μ΅°μ  κ°•μ κ³Ό μ•½μ μ„ μ§„λ‹¨ν•κ³  μµμ ν™” λ°©μ•μ„ μ μ‹ν•λ” Deep Research ν”„λ΅¬ν”„νΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
"""

from datetime import datetime


class PortfolioDiagnosisGenerator:
    """ν¬νΈν΄λ¦¬μ¤ μ •λ°€ μ§„λ‹¨ ν”„λ΅¬ν”„νΈ μƒμ„±κΈ°"""
    
    def __init__(self):
        """μ΄κΈ°ν™”"""
        pass
    
    def generate_diagnosis_prompt(self) -> str:
        """
        ν¬νΈν΄λ¦¬μ¤ μ •λ°€ μ§„λ‹¨μ„ μ„ν• μµμ ν™”λ
        Deep Research ν”„λ΅¬ν”„νΈλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
        
        Returns:
            str: μƒμ„±λ ν¬νΈν΄λ¦¬μ¤ μ§„λ‹¨ ν”„λ΅¬ν”„νΈ
        """
        today = datetime.now().strftime('%Yλ…„ %mμ›” %dμΌ')
        
        # λ§μ¤ν„° ν”„λ΅¬ν”„νΈ ν…ν”λ¦Ώ
        master_prompt_template = f"""# ν¬νΈν΄λ¦¬μ¤ μΆ…ν•© μ§„λ‹¨ λ° μµμ ν™” λ°©μ• λ³΄κ³ μ„ ({today})

## [μ¤‘μ” μ§€μ‹μ‚¬ν•­]
- **μ—­ν•  λ¶€μ—¬:** λ‹Ήμ‹ μ€ λ‚μ μµμΆ… μμ‚¬κ²°μ •μ„ λ•κΈ° μ„ν•΄, ν¬νΈν΄λ¦¬μ¤μ **κµ¬μ΅°μ μΈ κ°•μ (Strengths)κ³Ό μ•½μ (Weaknesses)μ„ λ¨λ‘ μ§„λ‹¨ν•λ” 'κ· ν• μ΅ν ν¬νΈν΄λ¦¬μ¤ μ „λµκ°€'**μ…λ‹λ‹¤. λ‹Ήμ‹ μ μ„λ¬΄λ” κ²°λ΅ μ„ λ‚΄λ¦¬λ” κ²ƒμ΄ μ•„λ‹λΌ, λ‚΄κ°€ ν¬νΈν΄λ¦¬μ¤μ κ±΄κ°• μƒνƒλ¥Ό μΆ…ν•©μ μΌλ΅ μ΄ν•΄ν•κ³  μµμ μ κ²°μ •μ„ λ‚΄λ¦΄ μ μλ„λ΅ μ–‘μ§μ μ¬λ£(μ–‘λ©΄μ  λ¶„μ„)λ¥Ό μ κ³µν•λ” κ²ƒμ…λ‹λ‹¤.
- **μ–Έμ–΄:** λ¨λ“  κ²°κ³Όλ¬Όμ€ λ°λ“μ‹ **ν•κΈ€**λ΅λ§ μ‘μ„±ν•΄μ£Όμ„Έμ”.

## λ¶„μ„ λ©ν‘:
μ²¨λ¶€λ 2κ°μ ν¬νΈν΄λ¦¬μ¤ νμΌ(`ν¬νΈν΄λ¦¬μ¤_ν„ν™©.csv`, `ν¬μ_λ…ΈνΈ.csv`)μ„ μΆ…ν•©μ μΌλ΅ λ¶„μ„ν•μ—¬, ν„μ¬ ν¬νΈν΄λ¦¬μ¤μ κµ¬μ΅°μ  κ°•μ κ³Ό μ•½μ μ„ μ§„λ‹¨ν•κ³ , μ¥κΈ° μμµλ¥  κ°μ„ μ„ μ„ν• κµ¬μ²΄μ μΈ μµμ ν™” λ°©μ•μ„ μ μ‹ν•μ‹μ¤.

## ν•µμ‹¬ μ§„λ‹¨ ν•­λ©:
*μ•„λ 4κ°€μ§€ ν•­λ©μ— λ€ν•΄, κ°κ°μ κ°•μ κ³Ό μ μ¬μ  μ•½μ μ„ κ· ν• μκ² λ¶„μ„ν•΄μ£Όμ‹­μ‹μ¤.*

**1. μμ‚° λ°°λ¶„ λ¶„μ„ (Asset Allocation):**
   - **κ°•μ :** ν„μ¬μ μ£Όμ‹/ν„κΈ λ° μ§€μ—­λ³„ λ°°λ¶„μ΄ μ‹μ¥ κΈ°νλ¥Ό ν¬μ°©ν•κ±°λ‚ λ¦¬μ¤ν¬λ¥Ό λ°©μ–΄ν•λ” λ° μμ–΄ μ–΄λ–¤ κΈμ •μ μΈ μ—­ν• μ„ ν•κ³  μλ”κ°€?
   - **μ μ¬μ  μ•½μ :** ν„μ¬μ μμ‚° λ°°λ¶„μ΄ νΉμ • μ‹μ¥ μ‹λ‚λ¦¬μ¤(μ: κΈ‰κ²©ν• κΈλ¦¬ μΈμƒ, νΉμ • μ§€μ—­μ κ²½κΈ° μΉ¨μ²΄)μ—μ„ λ…Έμ¶ν•  μ μλ” κ°€μ¥ ν° μ·¨μ•½μ μ€ λ¬΄μ—‡μΈκ°€?

**2. μ„Ήν„° λ° μ¤νƒ€μΌ λ¶„μ„ (Sector & Style Analysis):**
   - **κ°•μ :** `ν¬μ_λ…ΈνΈ.csv`λ¥Ό κΈ°μ¤€μΌλ΅, ν„μ¬ μ§‘μ¤‘ν•κ³  μλ” μ„Ήν„°λ‚ ν¬μ μ¤νƒ€μΌ(μ„±μ¥μ£Ό/κ°€μΉμ£Ό λ“±)μ΄ κ±°μ‹μ  νΈλ λ“μ™€ λ¶€ν•©ν•μ—¬ μ–»μ„ μ μλ” κ°€μ¥ ν° κΈ°νλ” λ¬΄μ—‡μΈκ°€?
   - **μ μ¬μ  μ•½μ :** νΉμ • μ„Ήν„°λ‚ μ¤νƒ€μΌμ— λ€ν• νΈμ¤‘μ΄ μ‹¬ν™”λ  κ²½μ° λ°μƒν•  μ μλ” κ°€μ¥ ν° λ¦¬μ¤ν¬λ” λ¬΄μ—‡μ΄λ©°, ν„μ¬ ν¬νΈν΄λ¦¬μ¤κ°€ λ†“μΉκ³  μλ” λ‹¤λ¥Έ μ λ§ μ„Ήν„°λ‚ μ¤νƒ€μΌμ€ μ—†λ”κ°€?

**3. λ¶„μ‚° ν¨κ³Ό λ¶„μ„ (Diversification Effect):**
   - **κ°•μ :** ν¬νΈν΄λ¦¬μ¤ λ‚΄μ—μ„ ν¨κ³Όμ μΌλ΅ μ„ν—μ„ λ¶„μ‚°μ‹μΌμ£Όλ” μ—­ν• μ„ ν•λ” μΆ…λ©μ΄λ‚ μμ‚°κµ°μ€ λ¬΄μ—‡μΈκ°€?
   - **μ μ¬μ  μ•½μ :** ν‘λ©΄μ μΌλ΅λ” λ‹¬λΌ λ³΄μ΄μ§€λ§ μ‹¤μ λ΅λ” μ μ‚¬ν• λ¦¬μ¤ν¬μ— λ…Έμ¶λμ–΄ μλ” 'μ¨κ²¨μ§„ μƒκ΄€κ΄€κ³„'λ” μ—†λ”κ°€? μ΄λ΅ μΈν•΄ μ‹μ¥ ν•λ½ μ‹ λ¶„μ‚° ν¨κ³Όκ°€ κΈ°λ€μ— λ―ΈμΉμ§€ λ»ν•  μ„ν—μ€ μ—†λ”κ°€?

**4. 'μ‹ λ…κ³Ό λΉ„μ¤‘'μ μΌμΉλ„ λ¶„μ„ (Conviction vs. Weighting Alignment):**
   - **κ°•μ :** λ‚μ λ†’μ€ ν¬μ ν™•μ‹ λ„μ™€ μ‹¤μ  λ†’μ€ λΉ„μ¤‘μ΄ μΌμΉν•μ—¬, λ‚μ μµκ³ μ μ•„μ΄λ””μ–΄κ°€ μ„±κ³Όλ΅ μ΄μ–΄μ§€κ³  μλ” μ΄μƒμ μΈ κ²½μ°λ” λ¬΄μ—‡μΈκ°€?
   - **μ μ¬μ  μ•½μ :** λ‚μ μ‹ λ…κ³Ό μ‹¤μ  λΉ„μ¤‘μ λ¶μΌμΉ(ν™•μ‹ μ€ λ‚®μΌλ‚ λΉ„μ¤‘μ΄ λ†’κ±°λ‚, ν™•μ‹ μ€ λ†’μΌλ‚ λΉ„μ¤‘μ΄ λ‚®μ€ κ²½μ°)λ΅ μΈν•΄ λ°μƒν•  μ μλ” κ°€μ¥ ν° λ¦¬μ¤ν¬ λλ” κΈ°νλΉ„μ©μ€ λ¬΄μ—‡μΈκ°€?

## κ²°κ³Όλ¬Ό μ”κµ¬μ‚¬ν•­:

### **1. μΆ…ν•© μ§„λ‹¨ (Overall Diagnosis)**
- **μΆ…ν•© κ±΄κ°• μ μ:** ν¬νΈν΄λ¦¬μ¤μ μ „λ°μ μΈ κ±΄κ°• μƒνƒλ¥Ό A(λ§¤μ° μ°μ), B(μ–‘νΈ), C(κ°μ„  ν•„μ”), D(μ„ν—) λ“±κΈ‰μΌλ΅ ν‰κ°€ν•κ³ , κ°€μ¥ ν° κ°•μ κ³Ό κ°€μ¥ μ‹κΈ‰ν•κ² κ°μ„ μ΄ ν•„μ”ν• μ•½μ μ„ κ°κ° μ”μ•½ν•  κ²ƒ.
- **ν•­λ©λ³„ μ§„λ‹¨:** μ„ 'ν•µμ‹¬ μ§„λ‹¨ ν•­λ©' 4κ°€μ§€ κ°κ°μ— λ€ν•΄, κ°•μ κ³Ό μ•½μ μ„ μ”μ•½ν•κ³  A/B/C/D λ“±κΈ‰μ„ λ¶€μ—¬ν•  κ²ƒ.

### **2. μµμ ν™”λ¥Ό μ„ν• κ³ λ ¤μ‚¬ν•­ (Considerations for Optimization)**
- μ§„λ‹¨ κ²°κ³Όλ¥Ό λ°”νƒ•μΌλ΅, ν¬νΈν΄λ¦¬μ¤λ¥Ό λ” κ±΄κ°•ν•κ² λ§λ“¤κΈ° μ„ν•΄ λ‚΄κ°€ κ³ λ ¤ν•΄λ³Ό μ μλ” κµ¬μ²΄μ μΈ μµμ ν™” λ°©μ•μ„ μ°μ„ μμ„ μμΌλ΅ 2~3κ°€μ§€ μ μ•ν•  κ²ƒ. (μ§μ ‘μ μΈ 'λ…λ Ή'μ΄ μ•„λ‹, μμ‚¬κ²°μ •μ„ λ•λ” 'μ μ•'μ ν•νƒλ΅ μ μ‹)
- **(μμ‹)** "1. κΈ°μ μ£Ό νΈμ¤‘ λ¦¬μ¤ν¬ μ™„ν™”λ¥Ό μ„ν•΄, ν™•μ‹ λ„κ°€ λ‚®μ€ AμΆ…λ© λΉ„μ¤‘μ„ μ μ§„μ μΌλ΅ μ¤„μ΄κ³ , κ·Έ μκΈμ„ ν„μ¬ ν¬νΈν΄λ¦¬μ¤μ— μ—†λ” ν—¬μ¤μΌ€μ–΄ μ„Ήν„°λ΅ μ¬λ°°λ¶„ν•λ” λ°©μ•μ„ κ³ λ ¤ν•΄λ³Ό μ μμµλ‹λ‹¤."

### **3. ν•µμ‹¬ λ¨λ‹ν„°λ§ μ§€ν‘ (Key Monitoring Metrics)**
- ν–¥ν›„ ν¬νΈν΄λ¦¬μ¤ κ±΄κ°• μƒνƒλ¥Ό μ§€μ†μ μΌλ΅ μ¶”μ ν•κΈ° μ„ν•΄ μ£ΌκΈ°μ μΌλ΅ μ κ²€ν•΄μ•Ό ν•  ν•µμ‹¬ μ§€ν‘ 3κ°€μ§€λ¥Ό μ μ‹ν•  κ²ƒ.
- **(μμ‹)** "1. μƒμ„ 1κ° μ„Ήν„°μ λΉ„μ¤‘ (50% μ΄κ³Ό μ‹ μ„ν— μ‹ νΈ), 2. ν¬νΈν΄λ¦¬μ¤μ™€ μ‹μ¥ μ§€μ(μ: S&P500)μ μƒκ΄€κ΄€κ³„, 3. μµλ€ λ‚™ν­(MDD) μ¶”μ΄"
"""
        
        return master_prompt_template.strip()


def main():
    """ν…μ¤νΈμ© λ©”μΈ ν•¨μ"""
    print("π§ ν¬νΈν΄λ¦¬μ¤ μ •λ°€ μ§„λ‹¨κΈ° ν…μ¤νΈ")
    print("=" * 50)
    
    generator = PortfolioDiagnosisGenerator()
    
    print("π“ ν¬νΈν΄λ¦¬μ¤ μ§„λ‹¨ ν”„λ΅¬ν”„νΈ μƒμ„± μ¤‘...")
    prompt = generator.generate_diagnosis_prompt()
    print(f"β… ν”„λ΅¬ν”„νΈ μƒμ„± μ™„λ£ (κΈΈμ΄: {len(prompt)}μ)")
    print(f"π“ ν”„λ΅¬ν”„νΈ λ―Έλ¦¬λ³΄κΈ°:\n{prompt[:300]}...")
    
    print("\nβ… ν…μ¤νΈκ°€ μ™„λ£λμ—μµλ‹λ‹¤!")


if __name__ == "__main__":
    main()
